(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver(t=>{for(const i of t)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&e(c)}).observe(document,{childList:!0,subtree:!0});function r(t){const i={};return t.integrity&&(i.integrity=t.integrity),t.referrerPolicy&&(i.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?i.credentials="include":t.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function e(t){if(t.ep)return;t.ep=!0;const i=r(t);fetch(t.href,i)}})();class a{constructor(n,r){this.timeStamp=Date.now(),this.type=n,this.id=crypto.randomUUID(),r&&Object.assign(this,r)}toJson(){return Object.fromEntries(Object.entries(this).filter(([n,r])=>{try{return JSON.stringify(r),!0}catch{return!1}}))}resolve(){}}const u=document.createElement("iframe");u.style.display="none";document.body.appendChild(u);var l=function(s,n,r,e){if(r==="a"&&!e)throw new TypeError("Private accessor was defined without a getter");if(typeof n=="function"?s!==n||!e:!n.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?e:r==="a"?e.call(s):e?e.value:n.get(s)},h=function(s,n,r,e,t){if(e==="m")throw new TypeError("Private method is not writable");if(e==="a"&&!t)throw new TypeError("Private accessor was defined without a setter");if(typeof n=="function"?s!==n||!t:!n.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e==="a"?t.call(s,r):t?t.value=r:n.set(s,r),r},o;class p extends EventTarget{constructor(){super(...arguments),this.actionHandlers={},o.set(this,void 0),this.headless=!1}connect(){this.client=new m;const n=async()=>{await this.onload(),this.client.send(new a("ready")),this.dispatchEvent(new CustomEvent("ready")),await this.onready()};return document.readyState==="complete"||document.readyState==="interactive"?setTimeout(n,1):window.addEventListener("DOMContentLoaded",n),new ResizeObserver(e=>{for(let t of e){const i=new a("resize",{dimensions:{width:t.contentRect.width,height:t.contentRect.height}});this.client.send(i)}}).observe(document.querySelector("html")),this.client.on("init",e=>{const t=e;this.headless=t.headless}),this.client.on("state",e=>{if(!f(e))throw new TypeError("Message doesn't match type StateMessage");JSON.stringify(e.state)!==JSON.stringify(l(this,o,"f"))&&(h(this,o,e.state,"f"),this.onrender(),this.dispatchEvent(new CustomEvent("render")))}),this.client.on("action",async e=>{if(!w(e))throw new TypeError("Message doesn't match type AppletMessage.");Object.keys(this.actionHandlers).includes(e.actionId)&&await this.actionHandlers[e.actionId](e.params)}),this}setActionHandler(n,r){this.actionHandlers[n]=r}set state(n){this.setState(n)}get state(){return l(this,o,"f")}async setState(n,r){const e=new a("state",{state:n});await this.client.send(e),h(this,o,n,"f"),r!==!1&&!this.headless&&(this.onrender(),this.dispatchEvent(new CustomEvent("render")))}onload(){}onready(){}onrender(){}}o=new WeakMap;function w(s){return s.type==="action"}function f(s){return s.type==="state"}class m{on(n,r){window.addEventListener("message",async e=>{if(e.data.type!==n)return;const t=new a(e.data.type,e.data);await r(t),window.parent.postMessage(new a("resolve",{id:t.id}),"*")})}send(n){return window.parent.postMessage(n.toJson(),"*"),new Promise(r=>{const e=t=>{t.data.type==="resolve"&&t.data.id===n.id&&(window.removeEventListener("message",e),r())};window.addEventListener("message",e)})}}const y=new p,g=document.getElementById("name"),d=y.connect();d.setActionHandler("set_name",({name:s})=>{d.setState({name:s})});d.onrender=()=>{var s;g.innerText=(s=d.state)==null?void 0:s.name};
